## 什么是springcloud
springcloud是一系列框架的集合，它利用springboot开发的便利性巧妙地简化分布式系统基础设施的开发，如服务注册发现、配置中心、消息总线、负载均衡、断路器、数据监控，使用springboot的开发风格做到一键启动和部署。

## springcloud核心组件有哪些
- Eureka：服务注册与发现
- Feign：基于动态代理机制，拼接请求url地址，发起请求
- Ribbon：实现客户端负载均衡，从一台服务的多台机器中选择一台
- Hystrix：提供线程池，不同的服务走不同的线程池，实现不同服务调用的隔离，避免了服务雪崩的问题
- Zuul：服务网关，由zuul网关转发请求给对应的服务

## 为什么使用eureka而不是zookeeper做服务注册发现？
1. zookeeper为CP模型，强调一致性；而eureka为AP模型，强调可用性。
2. 注册服务更重要的是可用性，我们可以接受短期内达不到一致性的状况。

## 什么是eureka的自我保护机制？
默认情况下，如果eureka server在一段时间内没有接受到某个微服务实例的心跳，便会注销该实例（默认为90秒）。

当eureka server节点在短时间内丢失了过多实例的连接（网络故障或频繁启停客户端），那么该节点将会进入自我保护模式，一旦进入了该模式，eureka server将不会删除服务注册表中的数据（即不会注销任何微服务）。当网络故障恢复后，该节点自动退出自我保护模式。

## zuul网关有哪些作用？
1. 请求转发
2. 灰度发布
3. 限流
4. 认证（jwt、oauth2）
5. 权限控制、ip白名单

## Ribbon是怎样和eureka结合的？
1. 首先ribbon从eureka中获取对应的服务列表
2. 然后ribbon使用负载均衡算法获得使用的服务
3. 最后ribbon调用对应的服务

## Feign的实现原理是什么？
feign的关键机制就是使用了动态代理
1. 首先如果你对某个接口定义了@FeignClient注解，那么Feign就会针对这个接口创建一个动态代理。
2. 接着你要是调用这个接口，本质就是会调用Feign创建的动态代理。
3. Feign的动态代理会根据接口上的@RequestMapping等注解来动态构建你要请求的服务的地址。
4. 最后针对这个地址，发起请求、解析响应。


## 链路追踪的实现原理是什么？
1. 为了实现请求跟踪，当请求发送到分布式系统的入口端点时，只需要服务跟踪框架为该请求创建一个唯一的跟踪标识，同时在分布式系统内部流转时，框架始终保持传递该唯一标识，直到返回给请求方为止，这个唯一标识就是Trace ID。

2. 为了统计各处理单元的时间延迟，当请求到达各个服务组件时，也通过一个唯一标识来标记它的开始及结束，这个唯一标识就是Span ID。


## hystrix断路器机制是怎样的？
熔断器如同电力保险丝，它可以实现快速失败，如果后端服务不可用，断路器会直接切断请求链，避免发送大量无效的请求影响系统吞吐量，并且断路器有自我检测并恢复的能力。

当请求后端服务失败数量超过一定比例(默认50%)，断路器会切换到开路状态，这时所有请求会直接失败而不会发送到后端服务。断路器保持在开路状态一段时间后(默认5秒)，自动切换到半开路状态(HALF-OPEN)，这时会判断下一次请求的返回情况，如果请求成功，断路器切回闭路状态(CLOSED)，否则重新切换到开路状态(OPEN)。